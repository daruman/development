#!/usr/bin/php
<?php
/**
 * webserverからdbserverへの接続テスト
 *
 * webserverとdbserver双方が起動している必要がある
 * `$ php TestConnectivity.php`
 */

$result = true;
try {
    $pdo = new PDO(
        'mysql:dbname={{ database.db }};host={{ db_ip_address }};charset=utf8',
        '{{ database.user }}',
        '{{ database.pass }}',
        array(
            PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
            PDO::ATTR_EMULATE_PREPARES => false,
        )
    );
    $pdo->query('SELECT * FROM {{ database.table }};');
} catch (Exception $e) {
    $result = false;
}

if ($result) {
    echo "success!\n";
} else {
    echo "error!\n";
}
